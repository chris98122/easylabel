{% extends 'base.html' %}

{% block content %}
<script src="/static/jquery-3.2.1.js" type="text/javascript"></script>	
<script src="/static/jquery.selectareas.js" type="text/javascript"></script>

    <img  class="img-responsive"src="{{ file }}"/>
   
    <form class="form-inline" role="form" method="post">
      <div class="form-group">
          <label id="img_id">0</label>
          {% if post['title'] %}
          <label for="title">Category： {{ post['title'] }}</label>
          {% endif %}
        <input type="text" class="form-control"  name="title" id="title" value="" required placeholder="请输入分类">
       <button type="submit" class="btn btn-default">提交</button>
  
</form>
    <button type="button" id="testbutton"  class="btn btn-primary">test</button>
    <button type="button" id="livingroom"  class="btn btn-primary">living room</button>
    <button type="button" id="bedroom" class="btn btn-primary">bedroom</button>
    <button type="button" id="kitchen"class="btn btn-primary">kitchen</button>
    <button type="button" id="restroom"class="btn btn-primary">restroom</button>
    <button type="button" id="others"class="btn btn-primary">others</button>
  </div>
  {% if post['title'] %}
  <button type="button" id="nextpic"  class="btn btn-primary">下一张图片</button>
  {% endif %}
  {% if id != 0%}
  <button type="button" id="formerpic"  class="btn btn-primary">上一张图片</button>
 
  {% endif %}
  <button type="button" id="goindex"  class="btn btn-primary">go to index</button>
  <img  id =test  src=""/>
   
{% endblock %}


{% block scripts %}
{{ super() }}


<script type="application/javascript" >
   $(document).ready(function () {
     var id=  new Number($('#img_id').html().trim());
     
    $('#livingroom').click(function () {
      $.post("{{ url_for('label.mainpage',id=id) }}",
      {
       title:"living room"
      },
      function(data,status){
      });
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });
    $('#bedroom').click(function () {
      $.post("{{ url_for('label.mainpage',id=id) }}",
      {
       title:"bedroom"
      },
      function(data,status){
      });
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });
    
    $('#kitchen').click(function () {
      $.post("{{ url_for('label.mainpage',id=id) }}",
      {
       title:"kitchen"
      },
      function(data,status){
      });
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });
    $('#restroom').click(function () {
      $.post("{{ url_for('label.mainpage',id=id) }}",
      {
       title:"restroom"
      },
      function(data,status){
      });
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });

    $('#others').click(function () {
      $.post("{{ url_for('label.mainpage',id=id) }}",
      {
       title:"others"
      },
      function(data,status){
      });
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });
    $('#nextpic').click(function () {
      
      window.location.href = "{{ url_for('label.mainpage', id=id+1) }}";
    });
    $('#formerpic').click(function () {
      
      window.location.href = "{{ url_for('label.mainpage', id=id-1) }}";
    });
    $('#goindex').click(function () {
      
      window.location.href ="{{ url_for('label.index') }}";
    });
    $('#testbutton').click(function () {
      id=Number($('#img_id').html().trim());
      alert(id);
      loadImage(id);
      id+=1;
      $("#img_id").html(id);
    });
  });

  function loadImage(id)
  {
	  console.log("INFO: " + "loadImage() from py"); 
    console.log(id);
	  $.ajax({
			type: 'POST',
			url: "{{ url_for('label.getNewImage') }}",
      data:{'id': id},
      cache:false, 
			dataType: "json",
			success: function(data)
					 {    var dataObj=eval("("+data+")");
						$('#test').attr("src",dataObj.url);
						 },
			dataType: 'html'
		});
	}

</script>
 {% endblock %}